var helpStr = 'app:\n'
+'allowFileAndNet()	保证ae允许写入文件和访问网络\n'
+'getOS()	获取操作系统名称，例如windows，mac';

module.exports = {
	help: helpStr,
	allowFileAndNet : function() {//保证ae允许写入文件
		if (isSecurityPrefSet()) return true;
		alert ("Be sure that 'Edit->Preferences->General->Allow Scripts to Write Files and Access Network' was ticked.");
		//alert ('脚本正在请求文件写入或访问网络，请到"首选项->常规"确保"允许脚本写入文件和访问网络"一项被勾选');	
		try{
			app.executeCommand(2359);
		}catch (e) {
			alert(e);
		}
		if (isSecurityPrefSet()) {
			return true;
		}else {
			return false;
		}
	
		function isSecurityPrefSet() {//是否可以写入文件
			try{
				var securitySetting = app.preferences.getPrefAsLong("Main Pref Section", "Pref_SCRIPTING_FILE_NETWORK_SECURITY");
				return (securitySetting == 1);
			}catch(e){
				return (securitySetting == 1);
			}
		}
	},
	getOS : function() {
		if($.os.indexOf( 'Windows' ) > -1) return 'windows';
		else if($.os.indexOf( 'Mac' ) > -1) return 'mac';
		else return '';
	}
}